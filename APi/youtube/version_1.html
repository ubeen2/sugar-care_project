<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>í™ˆíŠ¸ë ˆì´ë‹ ì¸ê¸° ì˜ìƒ</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        h1 { margin-bottom: 20px; }
        .container {
          display: flex;
          justify-content: center;
          gap: 20px;
        }
        .box {
          width: 500px;
          border: 2px solid black;
          padding: 10px;
        }
        .swiper { width: 100%; height: 320px; }
        .swiper-slide img { width: 100%; border-radius: 6px; }
        .title { font-size: 14px; margin-top: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .label { margin-top: 10px; font-weight: bold; }
    </style>
</head>
<body>
<h1>í˜ˆë‹¹ê´€ë¦¬ ì–´ë µì§€ ì•Šì•„ìš”!</h1>
<div class="container">
    <!-- 5~10ë¶„ëŒ€ -->
    <div class="box">
        <div class="swiper" id="swiper-short">
            <div class="swiper-wrapper" id="short-ex"></div>
        </div>
        <div class="label">5~10ë¶„ëŒ€ì˜ ê°„ë‹¨í•œ ìš´ë™</div>
    </div>
    <!-- 30ë¶„ ì´ìƒ -->
    <div class="box">
        <div class="swiper" id="swiper-long">
            <div class="swiper-wrapper" id="long-ex"></div>
        </div>
        <div class="label">30ë¶„ ì´ìƒì˜ ê³ ê°•ë„ ìš´ë™</div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
    const API_KEY = "AIzaSyBHviz484F_dMN-fzoYiWXzl7XpQPo0yZc";   // ğŸ”‘ ë°œê¸‰ë°›ì€ ìœ íŠœë¸Œ API í‚¤ ì…ë ¥
    const query = "í™ˆíŠ¸ë ˆì´ë‹";

    async function fetchVideos() {
      // ğŸ”¹ ì¸ê¸°ìˆœ(order=viewCount)ìœ¼ë¡œ 50ê°œ ì˜ìƒ ê°€ì ¸ì˜¤ê¸°
      const searchUrl = `https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&order=viewCount&maxResults=50&q=${encodeURIComponent(query)}&key=${API_KEY}`;
      const searchRes = await fetch(searchUrl);
      const searchData = await searchRes.json();
      const videoIds = searchData.items.map(item => item.id.videoId).join(",");

      // ğŸ”¹ ìƒì„¸ ì •ë³´ ìš”ì²­ (ê¸¸ì´ í¬í•¨)
      const videoUrl = `https://www.googleapis.com/youtube/v3/videos?part=snippet,contentDetails&id=${videoIds}&key=${API_KEY}`;
      const videoRes = await fetch(videoUrl);
      const videoData = await videoRes.json();

      function parseDuration(duration) {
        const match = duration.match(/PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?/);
        const hours = parseInt(match[1] || 0);
        const minutes = parseInt(match[2] || 0);
        const seconds = parseInt(match[3] || 0);
        return hours * 3600 + minutes * 60 + seconds;
      }

      let shortCount = 0;
      let longCount = 0;

      videoData.items.forEach(item => {
        const duration = parseDuration(item.contentDetails.duration);
        const videoId = item.id;
        const title = item.snippet.title;
        const thumbnail = item.snippet.thumbnails.medium.url;
        const url = `https://www.youtube.com/watch?v=${videoId}`;

        // 5~10ë¶„ëŒ€ (300~600ì´ˆ)
        if (duration >= 300 && duration <= 600 && shortCount < 5) {
          document.getElementById("short-ex").innerHTML += `
            <div class="swiper-slide">
              <a href="${url}" target="_blank">
                <img src="${thumbnail}" alt="${title}">
                <div class="title">${title}</div>
              </a>
            </div>`;
          shortCount++;
        }

        // 30ë¶„ ì´ìƒ (>= 1800ì´ˆ)
        if (duration >= 1800 && longCount < 5) {
          document.getElementById("long-ex").innerHTML += `
            <div class="swiper-slide">
              <a href="${url}" target="_blank">
                <img src="${thumbnail}" alt="${title}">
                <div class="title">${title}</div>
              </a>
            </div>`;
          longCount++;
        }
      });

      // ğŸ”¹ ê²°ê³¼ ì—†ì„ ê²½ìš° ì•ˆë‚´ í‘œì‹œ
      if (shortCount === 0) {
        document.getElementById("short-ex").innerHTML = `<div class="swiper-slide"><div class="title">âš ï¸ 5~10ë¶„ ì˜ìƒ ì—†ìŒ</div></div>`;
      }
      if (longCount === 0) {
        document.getElementById("long-ex").innerHTML = `<div class="swiper-slide"><div class="title">âš ï¸ 30ë¶„ ì´ìƒ ì˜ìƒ ì—†ìŒ</div></div>`;
      }

      // ìŠ¬ë¼ì´ë” ì´ˆê¸°í™” , ìŠ¬ë¼ì´ë” ì†ë„
      new Swiper("#swiper-short", { loop: true, autoplay: { delay: 5000 }});
      new Swiper("#swiper-long", { loop: true, autoplay: { delay: 5000 }});
    }

    fetchVideos();
</script>
</body>
</html>
